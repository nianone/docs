# i3速通版

## 1.联网

```
iwctl
device list
station wlan0 scan
station wlan0 get-networks
station wlan0 connect "Nianyi-5G"
remake&21
```

## 2.更新系统时间

```
timedatectl
```

## 3.分区

```
fdisk /dev/nvme0n1

mkfs.ext4 /dev/nvme0n1p2 
mkfs.ext4 /dev/nvme0n1p3
mkfs.fat -F 32 /dev/nvme0n1p1

mount /dev/nvme0n1p2 /mnt
mount --mkdir /dev/nvme0n1p3 /mnt/home
mount --mkdir /dev/nvme0n1p1 /mnt/boot
```

交换分区

```
dd if=/dev/zero of=/mnt/swapfile bs=1M count=11585 status=progress
chmod 0600 /mnt/swapfile
mkswap -U clear /mnt/swapfile
swapon /mnt/swapfile
```

## 4.安装软件

```
reflector -p https -c China --delay 3 --completion-percent 95 --sort rate --save /etc/pacman.d/mirrorlist

pacman-key --init  # 初始化密钥环
pacman-key --populate
pacman -Sy archlinux-keyring  # 更新 archlinux-keyring

pacstrap /mnt base linux linux-firmware vi sudo vim networkmanager base-devel
```

## 5.自动挂载分区

```
genfstab -U /mnt >> /mnt/etc/fstab
```

## 6.chroot

```
arch-chroot /mnt

ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime
hwclock --systohc

vim /etc/locale.gen
--------------------begen
en_US.UTF-8 UTF-8
zh_CN.UTF-8 UTF-8
--------------------end
locale-gen
echo "LANG=en_US.UTF-8" > /etc/locale.conf
```

## 7.网络配置

```
# 配置主机名
echo "nianyi" > /etc/hostname
# 开机启动网络管理器
systemctl enable NetworkManager.service
```

## 8.设置root密码

```
passwd

pacman -S amd-ucode grub efibootmgr openssh
grub-install --target=x86_64-efi --efi-directory=/boot --bootloader-id=GRUB
grub-mkconfig -o /boot/grub/grub.cfg

vim /etc/ssh/sshd_config
--------------begen取消注释修改为
Port 22
ListenAddress 0.0.0.0
ListenAddress ::
PermitRootLogin yes
-------------end
# 开机启动
systemctl enable sshd

useradd -m -G wheel ny
passwd ny

visudo
-----------begen 将下面这行的注释去掉
%wheel ALL=(ALL:ALL) ALL
-----------end
```

## 9.重启

```
# 退出chroot环境
exit
# 关闭交换文件
swapoff /mnt/swapfile
# 取消挂载 /mnt
umount -R /mnt
# 重启
reboot
```

## 10.配置pacman

启用颜色显示和并行下载

```text
vim /etc/pacman.conf
--------------------
Color
ParallelDownloads = 5
```

添加32位软件仓库

```text
vim /etc/pacman.conf
--------------------
[multilib]
Include = /etc/pacman.d/mirrorlist
```

添加非官方软件仓库：在文件最后添加

```text
/etc/pacman.conf
----------------
[archlinuxcn]
Server = https://mirrors.bfsu.edu.cn/archlinuxcn/$arc----------
sudo pacman -S archlinuxcn-keyring
```

## 11.安装aur

需要先安装 编辑工具包

```text
sudo pacman -S yay
```

## 12.pacman安装zsh

pacman 安装

```text
sudo pacman -S zsh
```

查看安装位置

```text
which zsh
```

查看已有的shell

```text
chsh -l
```

设置zsh为默认shell

```text
chsh -s /bin/zsh
```

安装 oh-my-zsh 官方主页：https://ohmyz.sh/

```text
# clone 项目
git clone https://gitee.com/mirrors/oh-my-zsh.git
# 运行脚本
sh ~/oh-my-zsh/tools/install.sh
```

高亮显示插件 zsh-syntax-highlighting，为ZSH Shell提供语法高亮显示。

```text
zsh #运行zsh
cd $HOME/.oh-my-zsh/plugins
#下载代码
git clone https://github.com/zsh-users/zsh-syntax-highlighting.git
#自动配置
echo "source ${(q-)PWD}/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh" >> ${ZDOTDIR:-$HOME}/.zshrc
```

自动补全插件 zsh-autosuggestions

```text
cd $HOME/.oh-my-zsh/plugins
#下载代码
git clone https://github.com/zsh-users/zsh-autosuggestions ${ZSH_CUSTOM:-~/.oh-my-zsh/}/plugins/zsh-autosuggestions
```

```text
vim ~/.zshrc
----------------------
plugins=(git)

plugins=(
    git
    zsh-autosuggestions
)
```

重新加载配置文件

```text
source $ZSH/oh-my-zsh.sh
```

> 参考：
>
> https://zhuanlan.zhihu.com/p/350917930
> https://blog.csdn.net/lxyoucan/article/details/115279860

## 13.i3安装

```
yay -S i3-wm polybar rofi xorg-server xorg-xinit picom feh alacritty wqy-microhei fcitx fcitx-im fcitx-configtool google-chrome

echo "exec i3" > ~/.xinitrc

mkdir ~/.config/polybar
cp /usr/share/doc/polybar/examples/config.ini ~/.config/polybar/

vim ~/.config/polybar/launch.sh
---------------add
#!/bin/bash

killall -q polybar

while pgrep -u $UID -x polybar >/dev/null; do sleep 1; done

polybar &

echo "Polybar launched..."
---------------
chmod u+x ~/.config/polybar/launch.sh


安装i3


vim ~/.config/i3/config
------------------------modify

#bar {
#	status_command i3status
#}

bindsym $mod+return exec alacritty
bindsym $mod+d exec --no-startup-id "rofi -modi drun, run -show drun" 

exec --no-startup-id fcitx-autostart
exec_always --no-startup-id ~/.config/polybar/launch.sh
exec_always --no-startup-id feh --randomize --bg-fill ~/background/cover.jpg
------------------------

vim ~/.xinitrc
--------------add
export LANG=zh_CN.UTF-8
export LANGUAGE=zh_CN:en_US
export LC_CTYPE=en_US.UTF-8


export GTK_IM_MODULE=fcitx
export QT_IM_MODULE=fcitx
export XMODIFIERS=@im=fcitx
--------------end
```

