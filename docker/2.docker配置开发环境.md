# docker配置开发环境

docker可以很方便的部署开发环境

```bash
-d         后台启动
--name     容器名称
-m         最大内存
-p         端口映射 主机：容器
-e         设置环境变量
-v         绑定一个卷/目录
--restart always 总是随着docker的启动而启动
```

## 1.MySQL 
 
 ```text
 docker pull mysql:5.7
 docker pull mysql:8.0.19
 ```

 运行
 ```text
docker run -d \
--name mysql8.0 \
-m 1024M \
-p 3306:3306 \
-e MYSQL_ROOT_PASSWORD=MysqlPwd \
-v /home/ny/data/mysql/data:/var/lib/mysql/ \
--restart always \
mysql:8.0.19

 ```

 ## 2.Redis

```text
docker pull redis:latest
```

```text
docker run -d \
--name redis \
-m 512M \
-p 6379:6379 \
-v /home/ny/data/redis/data:/data \
--restart=always \
redis:latest

# 配置文件
-v ~/data/redis/redis.conf:/etc/redis/redis.conf \
```

## 3.aria2

```text
docker pull p3terx/aria2-pro
```

```text
docker run -d \
--name aria2 \
--restart unless-stopped \
--log-opt max-size=1m \
-e PUID=$UID \
-e PGID=$GID \
-e UMASK_SET=022 \
-e RPC_SECRET=prc_password \
-e RPC_PORT=6800 \
-e LISTEN_PORT=6888 \
-p 16800:6800 \
-p 16888:6888 \
-p 16888:6888/udp \
-v /home/ny/.config/aria2/config:/config \
-v /home/ny/Downloads:/downloads \
p3terx/aria2-pro
```

### 启动容器命令参数详解
用户和组设定：
PUID=$UID、PGID=$GID这2个定义用户和用户组的环境变量，限定了aria2以什么用户和用户组运行，不指定则默认使用nobady用户和nogroup用户组，但在使用FileRun网盘时，会因权限问题无法删除或改名aria2下载好的文件，所以PUID和GUID要指定为和WEB环境的运行用户和用户组一致，比如WEB环境运行的用户及对应的用户组都是WWW，对应的uid和gid都是1001，那就要指定PUID=1001、PGID=1001，这样在FileRun网盘中就可以正常的进行删除和修改操作了；
几个环境变量:
-e UMASK_SET=022 ，设置umask，默认值022；
-e RPC_SECRET=，设置RPC密钥，用于AriaNg与Aria2的通讯验证使用；
-e RPC_PORT=6800，设置PRC通讯端口（与宿主主机的端口映射一致）；
-e LISTEN_PORT=6888，BT 监听端口（TCP）、DHT 监听端口（UDP）设置，即 Aria2 配置中listen-port与dht-listen-port选项定义的端口。如果没有设置，配置文件中的默认值为6888。
容器目录挂载，将/downloads挂载到宿主主机的/root/aria2/downloads:/downloads目录，即FileRun的数据目录中，方便下载完成直接在网盘中查看；配置文件挂载到指定的宿主主机目录/root/aria2/config中，宿主主机的目录根据实际情况自行修改；
3个端口映射：
-p 16800:6800，为RPC 通讯端口映射；
-p 16888:6888，为BT 监听端口（TCP）映射，即 Aria2 配置中listen-port选项定义的端口；
-p 16888:6888/udp，为DHT 监听端口（UDP）映射，即 Aria2 配置中dht-listen-port选项定义的端口。
